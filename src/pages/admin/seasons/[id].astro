---
export const prerender = false;
import { checkAuth } from '../../../features/cms/lib/auth-astro';
import { getSeasonById } from '../../../features/cms/lib/queries';

const user = await checkAuth(Astro.request);
if (!user) {
  return Astro.redirect('/admin/login', 302);
}

const { id } = Astro.params;

// Try to fetch season to get leagueId for redirect
let redirectUrl = '/admin/leagues';
if (id) {
  const season = await getSeasonById(id);
  if (season?.leagueId) {
    redirectUrl = `/admin/leagues/${season.leagueId}`;
  }
}
---

<Astro.response.redirect(redirectUrl, 302) />


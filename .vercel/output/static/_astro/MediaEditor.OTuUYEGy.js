import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as d}from"./index.Z6aMusZW.js";import{B as h}from"./button.BWaXVklz.js";import{I as c}from"./input.DYfGnR1o.js";import{L as n}from"./label.ByuxEscq.js";import{C as S,a as E,b as A,c as F,d as M}from"./card.YuvTJRVG.js";import{A as T,a as D}from"./alert.BWe5-cIC.js";import{S as p}from"./skeleton.B3vSOSjr.js";import{S as L,a as U,b as O,c as R,d as k}from"./select.B__e_A2K.js";import{A as G}from"./arrow-left.DTOvvTq7.js";import{C as P}from"./circle-alert.DSB0BqUH.js";import"./utils.CDN07tui.js";import"./index.CO5Cc353.js";import"./index.EfZGvMir.js";import"./index.CTkzGMNT.js";import"./Combination.UCZQMOc2.js";import"./index.D9ngwW3m.js";import"./chevron-up.BnPhcTyb.js";import"./createLucideIcon.DXTouTbc.js";import"./check.BilKxX2O.js";function ie({mediaId:r}){const[g,u]=d.useState(!!r),[i,x]=d.useState(!1),[f,m]=d.useState(""),[s,l]=d.useState({title:"",url:"",type:"IMAGE",thumbnail:"",tags:""});d.useEffect(()=>{r&&v()},[r]);const v=async()=>{try{u(!0);const t=await fetch(`/api/media/${r}`);if(!t.ok)throw new Error("Failed to fetch media");const a=await t.json();l({title:a.title,url:a.url,type:a.type,thumbnail:a.thumbnail||"",tags:a.tags?a.tags.join(", "):""})}catch(t){m(t.message||"Failed to load media")}finally{u(!1)}},y=async t=>{t.preventDefault(),x(!0),m("");try{const a=r?`/api/media/${r}`:"/api/media",N=r?"PUT":"POST",w=s.tags?s.tags.split(",").map(o=>o.trim()).filter(o=>o.length>0):[],C={...s,tags:w,thumbnail:s.thumbnail||void 0},j=await fetch(a,{method:N,headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!j.ok){const o=await j.json();throw new Error(o.error||"Failed to save media")}window.location.href="/admin/media"}catch(a){m(a.message||"Failed to save media")}finally{x(!1)}};if(g)return e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{className:"h-12 w-full"}),e.jsx(p,{className:"h-64 w-full"}),e.jsx(p,{className:"h-12 w-full"})]});const b=["IMAGE","VIDEO","AUDIO"];return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 pb-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-heading font-semibold mb-2 text-foreground",children:r?"Edit Media":"Add New Media"}),e.jsx("p",{className:"text-muted-foreground",children:r?"Update media information":"Add a new media item to the gallery"})]}),e.jsx(h,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/admin/media","data-astro-prefetch":!0,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Back to Gallery"]})})]}),f&&e.jsxs(T,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(D,{children:f})]}),e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(A,{children:"Media Information"}),e.jsx(F,{children:"Enter the details for this media item"})]}),e.jsx(M,{children:e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"title",children:["Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(c,{id:"title",type:"text",value:s.title,onChange:t=>l(a=>({...a,title:t.target.value})),required:!0,disabled:i,placeholder:"Media title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"type",children:["Type ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(L,{value:s.type,onValueChange:t=>l(a=>({...a,type:t})),disabled:i,children:[e.jsx(U,{id:"type",children:e.jsx(O,{placeholder:"Select media type"})}),e.jsx(R,{children:b.map(t=>e.jsx(k,{value:t,children:t},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"url",children:["URL ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(c,{id:"url",type:"url",value:s.url,onChange:t=>l(a=>({...a,url:t.target.value})),required:!0,disabled:i,placeholder:"https://example.com/image.jpg"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Full URL to the media file (image, video, or audio)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"thumbnail",children:"Thumbnail URL"}),e.jsx(c,{id:"thumbnail",type:"url",value:s.thumbnail,onChange:t=>l(a=>({...a,thumbnail:t.target.value})),disabled:i,placeholder:"https://example.com/thumbnail.jpg"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Optional thumbnail URL (useful for videos and audio)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tags",children:"Tags"}),e.jsx(c,{id:"tags",type:"text",value:s.tags,onChange:t=>l(a=>({...a,tags:t.target.value})),disabled:i,placeholder:"tag1, tag2, tag3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Comma-separated tags for organizing media"})]}),s.url&&s.type==="IMAGE"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Preview"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Preview",className:"w-full max-h-[300px] object-contain",onError:t=>{t.target.style.display="none"}})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{type:"submit",disabled:i,children:i?"Saving...":r?"Update Media":"Add Media"}),e.jsx(h,{type:"button",variant:"outline",asChild:!0,children:e.jsx("a",{href:"/admin/media","data-astro-prefetch":!0,children:"Cancel"})})]})]})})]})]})}export{ie as default};

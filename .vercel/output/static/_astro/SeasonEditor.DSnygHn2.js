import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.Z6aMusZW.js";import{B as h}from"./button.BWaXVklz.js";import{I as d}from"./input.DYfGnR1o.js";import{L as l}from"./label.ByuxEscq.js";import{T as A}from"./textarea.ntLCWltE.js";import{C as T,a as O,b as k,c as q,d as B}from"./card.YuvTJRVG.js";import{A as U,a as V}from"./alert.BWe5-cIC.js";import{S as u}from"./skeleton.B3vSOSjr.js";import{S as v,a as S,b as N,c as w,d as p}from"./select.B__e_A2K.js";import{A as P}from"./arrow-left.DTOvvTq7.js";import{C as $}from"./circle-alert.DSB0BqUH.js";import{L as H}from"./loader-circle.DAcaG-Yh.js";import{S as J}from"./save.BcFhAao1.js";import{X as R}from"./x.B_0Xwiyu.js";import"./utils.CDN07tui.js";import"./index.CO5Cc353.js";import"./index.EfZGvMir.js";import"./index.CTkzGMNT.js";import"./Combination.UCZQMOc2.js";import"./index.D9ngwW3m.js";import"./chevron-up.BnPhcTyb.js";import"./createLucideIcon.DXTouTbc.js";import"./check.BilKxX2O.js";function pe({seasonId:r}){const[y,x]=o.useState(!!r),[i,g]=o.useState(!1),[j,c]=o.useState(""),[D,C]=o.useState([]),[t,n]=o.useState({name:"",slug:"",description:"",startDate:"",endDate:"",leagueId:"",active:!0});o.useEffect(()=>{b(),r&&F()},[r]);const b=async()=>{try{const a=await fetch("/api/leagues");if(!a.ok)throw new Error("Failed to fetch leagues");const s=await a.json();C(s)}catch(a){console.error("Error fetching leagues:",a)}},F=async()=>{try{x(!0);const a=await fetch(`/api/seasons/${r}`);if(!a.ok)throw new Error("Failed to fetch season");const s=await a.json(),m=s;n({name:s.name,slug:s.slug,description:s.description||"",startDate:new Date(s.startDate).toISOString().slice(0,10),endDate:new Date(s.endDate).toISOString().slice(0,10),leagueId:m.league?.id||s.leagueId||"",active:s.active})}catch(a){c(a.message||"Failed to load season")}finally{x(!1)}},E=async a=>{a.preventDefault(),g(!0),c("");try{const s=r?`/api/seasons/${r}`:"/api/seasons",m=r?"PUT":"POST",L={...t,slug:t.slug||void 0,startDate:new Date(t.startDate).toISOString(),endDate:new Date(t.endDate).toISOString(),leagueId:t.leagueId},f=await fetch(s,{method:m,headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!f.ok){const I=await f.json();throw new Error(I.error||"Failed to save season")}window.location.href="/admin/seasons"}catch(s){c(s.message||"Failed to save season")}finally{g(!1)}};return y?e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{className:"h-12 w-full"}),e.jsx(u,{className:"h-64 w-full"}),e.jsx(u,{className:"h-12 w-full"})]}):e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 pb-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-heading font-semibold mb-2 text-foreground",children:r?"Edit Season":"Create New Season"}),e.jsx("p",{className:"text-muted-foreground",children:r?"Update season information":"Create a new season"})]}),e.jsx(h,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/admin/seasons","data-astro-prefetch":!0,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Back to List"]})})]}),j&&e.jsxs(U,{variant:"destructive",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx(V,{children:j})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsx(k,{children:"Season Information"}),e.jsx(q,{children:"Enter the details for this season"})]}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"name",children:["Season Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(d,{id:"name",type:"text",value:t.name,onChange:a=>n(s=>({...s,name:a.target.value})),required:!0,disabled:i,placeholder:"e.g., 2024-2025"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"slug",children:"Slug"}),e.jsx(d,{id:"slug",type:"text",value:t.slug,onChange:a=>n(s=>({...s,slug:a.target.value})),placeholder:"Auto-generated from name",disabled:i}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Leave empty to auto-generate from name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(A,{id:"description",rows:4,value:t.description,onChange:a=>n(s=>({...s,description:a.target.value})),disabled:i,placeholder:"Season description"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"leagueId",children:["League ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(v,{value:t.leagueId,onValueChange:a=>n(s=>({...s,leagueId:a})),required:!0,disabled:i,children:[e.jsx(S,{id:"leagueId",children:e.jsx(N,{placeholder:"Select a league"})}),e.jsx(w,{children:D.map(a=>e.jsx(p,{value:a.id,children:a.name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"active",children:"Status"}),e.jsxs(v,{value:t.active?"true":"false",onValueChange:a=>n(s=>({...s,active:a==="true"})),disabled:i,children:[e.jsx(S,{id:"active",children:e.jsx(N,{})}),e.jsxs(w,{children:[e.jsx(p,{value:"true",children:"Active"}),e.jsx(p,{value:"false",children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"startDate",children:["Start Date ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(d,{id:"startDate",type:"date",value:t.startDate,onChange:a=>n(s=>({...s,startDate:a.target.value})),required:!0,disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"endDate",children:["End Date ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(d,{id:"endDate",type:"date",value:t.endDate,onChange:a=>n(s=>({...s,endDate:a.target.value})),required:!0,disabled:i})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{type:"submit",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),r?"Update Season":"Create Season"]})}),e.jsx(h,{type:"button",variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/admin/seasons","data-astro-prefetch":!0,children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Cancel"]})})]})]})]})}export{pe as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/lucide-react.elpkBkAp.js","_astro/createLucideIcon.DXTouTbc.js","_astro/index.Z6aMusZW.js","_astro/trophy.D9FOkt9-.js","_astro/arrow-left.DTOvvTq7.js","_astro/briefcase.Dy88TS9y.js","_astro/check.BilKxX2O.js","_astro/chevron-up.BnPhcTyb.js","_astro/chevron-right.CntEDD8B.js","_astro/circle-alert.DSB0BqUH.js","_astro/circle-check-big.C0mK4qk5.js","_astro/circle-x.BXci9Ly8.js","_astro/circle.p2pi6svn.js","_astro/file-text.CSp1dnUh.js","_astro/info.COjwR0tB.js","_astro/loader-circle.DAcaG-Yh.js","_astro/square-pen.CdCizJHo.js","_astro/trash-2.GrLsMpmQ.js","_astro/shield.DPFejS3v.js","_astro/save.BcFhAao1.js","_astro/user.zdQziaxZ.js","_astro/users.DbM1g3zt.js","_astro/x.B_0Xwiyu.js"])))=>i.map(i=>d[i]);
import{_ as J}from"./preload-helper.BlTxHScW.js";import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.Z6aMusZW.js";import{B as w}from"./button.BWaXVklz.js";import{C as q,a as K,b as Q,c as X}from"./card.CoMIDSCG.js";import{B as W}from"./badge.DPtWg24B.js";import{A as G,a as $}from"./alert.BWe5-cIC.js";import{S as ie}from"./skeleton.B3vSOSjr.js";import{I as F}from"./input.DYfGnR1o.js";import{L as x}from"./label.ByuxEscq.js";import{T as ne}from"./textarea.ntLCWltE.js";import{C as ce}from"./checkbox.D89wNvvK.js";import{S as R,a as D,b as C,c as L,d as f}from"./select.C_1Jy99F.js";import{D as ee,a as se,b as ae,c as te,d as re,e as le}from"./dialog.RWPW4o4R.js";import{d as de,c as oe,a as me,g as he,e as xe,b as ue}from"./team-helpers.vPMKc0Vn.js";import{a as je}from"./league-helpers.1oObcXhs.js";import"./utils.CDN07tui.js";import"./index.CO5Cc353.js";import"./index.EfZGvMir.js";import"./index.lnW5t9aA.js";import"./index.D9ngwW3m.js";import"./index.DUJzU2eK.js";import"./check.BilKxX2O.js";import"./createLucideIcon.DXTouTbc.js";import"./Combination.LMohFq6j.js";import"./chevron-up.BnPhcTyb.js";import"./index.8pPTknrX.js";import"./x.B_0Xwiyu.js";function Ne({team1Id:j,team2Id:N,isOpen:r,onClose:b,onSuccess:M}){const[T,U]=c.useState(!1),[A,E]=c.useState(""),[O,I]=c.useState([]),[d,u]=c.useState({firstName:"",lastName:"",height:"",weight:"",image:"",bio:"",teamId:"",position:"",jerseyNumber:""}),[g,t]=c.useState({});c.useEffect(()=>{J(()=>import("./lucide-react.elpkBkAp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])).then(l=>{t({AlertCircle:l.AlertCircle,Loader2:l.Loader2})})},[]),c.useEffect(()=>{r&&(v(),u({firstName:"",lastName:"",height:"",weight:"",image:"",bio:"",teamId:"",position:"",jerseyNumber:""}),E(""))},[r,j,N]);const v=async()=>{try{if(j||N){const l=[];j&&l.push(fetch(`/api/teams/${j}`).then(p=>p.ok?p.json():null)),N&&l.push(fetch(`/api/teams/${N}`).then(p=>p.ok?p.json():null));const h=(await Promise.all(l)).filter(p=>p!==null);I(h),h.length>0&&u(p=>({...p,teamId:h[0].id}))}else{const l=await fetch("/api/teams");if(l.ok){const n=await l.json();I(n),n.length>0&&u(h=>({...h,teamId:n[0].id}))}}}catch(l){console.error("Failed to fetch teams:",l)}},S=async l=>{l.preventDefault(),E(""),U(!0);try{if(!d.firstName||!d.lastName)throw new Error("First name and last name are required");const n={firstName:d.firstName.trim(),lastName:d.lastName.trim(),height:d.height.trim()||void 0,weight:d.weight.trim()||void 0,image:d.image.trim()||void 0,bio:d.bio.trim()||void 0,teamId:d.teamId||void 0,position:d.position||void 0,jerseyNumber:d.jerseyNumber?parseInt(d.jerseyNumber):void 0};console.log("Creating player with data:",n);const h=await fetch("/api/players",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!h.ok){const k=await h.json().catch(()=>({error:"Unknown error"}));throw console.error("Failed to create player:",k),new Error(k.error||"Failed to create player")}const p=await h.json();console.log("Player created successfully:",p),M(p)}catch(n){E(n.message||"Failed to create player")}finally{U(!1)}};return e.jsx(ee,{open:r,onOpenChange:l=>{l||b()},children:e.jsxs(se,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Add New Player"}),e.jsx(re,{children:"Create a new player to add to this match."})]}),A&&e.jsxs(G,{variant:"destructive",children:[g.AlertCircle?e.jsx(g.AlertCircle,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),e.jsx($,{children:A})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"new-player-firstName",children:["First Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(F,{id:"new-player-firstName",type:"text",value:d.firstName,onChange:l=>u(n=>({...n,firstName:l.target.value})),required:!0,placeholder:"John"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"new-player-lastName",children:["Last Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(F,{id:"new-player-lastName",type:"text",value:d.lastName,onChange:l=>u(n=>({...n,lastName:l.target.value})),required:!0,placeholder:"Doe"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-height",children:"Height"}),e.jsx(F,{id:"new-player-height",type:"text",value:d.height,onChange:l=>u(n=>({...n,height:l.target.value})),placeholder:`6'2"`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-weight",children:"Weight"}),e.jsx(F,{id:"new-player-weight",type:"text",value:d.weight,onChange:l=>u(n=>({...n,weight:l.target.value})),placeholder:"84 kg"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-image",children:"Image URL"}),e.jsx(F,{id:"new-player-image",type:"url",value:d.image,onChange:l=>u(n=>({...n,image:l.target.value})),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-bio",children:"Bio"}),e.jsx(ne,{id:"new-player-bio",value:d.bio,onChange:l=>u(n=>({...n,bio:l.target.value})),placeholder:"Player biography...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-teamId",children:"Team"}),e.jsxs(R,{value:d.teamId||void 0,onValueChange:l=>u(n=>({...n,teamId:l})),children:[e.jsx(D,{id:"new-player-teamId",children:e.jsx(C,{placeholder:"Select a team"})}),e.jsx(L,{children:O.map(l=>e.jsx(f,{value:l.id,children:l.name},l.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-position",children:"Position"}),e.jsxs(R,{value:d.position||void 0,onValueChange:l=>u(n=>({...n,position:l})),children:[e.jsx(D,{id:"new-player-position",children:e.jsx(C,{placeholder:"Select position"})}),e.jsxs(L,{children:[e.jsx(f,{value:"PG",children:"Point Guard (PG)"}),e.jsx(f,{value:"SG",children:"Shooting Guard (SG)"}),e.jsx(f,{value:"SF",children:"Small Forward (SF)"}),e.jsx(f,{value:"PF",children:"Power Forward (PF)"}),e.jsx(f,{value:"C",children:"Center (C)"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-player-jerseyNumber",children:"Jersey #"}),e.jsx(F,{id:"new-player-jerseyNumber",type:"number",value:d.jerseyNumber,onChange:l=>u(n=>({...n,jerseyNumber:l.target.value})),min:"0",max:"99",placeholder:"23"})]}),e.jsxs(le,{children:[e.jsx(w,{type:"button",variant:"outline",onClick:b,disabled:T,children:"Cancel"}),e.jsx(w,{type:"submit",disabled:T,children:T?e.jsxs(e.Fragment,{children:[g.Loader2?e.jsx(g.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Creating..."]}):"Create Player"})]})]})]})})}const Z={TWO_POINT_MADE:"2-Point Made",TWO_POINT_MISSED:"2-Point Missed",THREE_POINT_MADE:"3-Point Made",THREE_POINT_MISSED:"3-Point Missed",FREE_THROW_MADE:"Free Throw Made",FREE_THROW_MISSED:"Free Throw Missed",ASSIST:"Assist",REBOUND_OFFENSIVE:"Offensive Rebound",REBOUND_DEFENSIVE:"Defensive Rebound",STEAL:"Steal",BLOCK:"Block",TURNOVER:"Turnover",FOUL_PERSONAL:"Personal Foul",FOUL_TECHNICAL:"Technical Foul",FOUL_FLAGRANT:"Flagrant Foul",SUBSTITUTION_IN:"Sub In",SUBSTITUTION_OUT:"Sub Out",TIMEOUT:"Timeout",INJURY:"Injury",OTHER:"Other"};function pe({matchId:j,team1Id:N,team2Id:r,isOpen:b,onClose:M,onSuccess:T}){const[U,A]=c.useState([]),[E,O]=c.useState([]),[I,d]=c.useState(!1),[u,g]=c.useState(""),[t,v]=c.useState({eventType:"TWO_POINT_MADE",minute:"",teamId:"",playerId:"",assistPlayerId:"",description:""}),[S,l]=c.useState({});c.useEffect(()=>{J(()=>import("./lucide-react.elpkBkAp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])).then(a=>{l({AlertCircle:a.AlertCircle,Loader2:a.Loader2,Activity:a.Activity,Goal:a.Goal,Square:a.Square,Users:a.Users,Clock:a.Clock})})},[]),c.useEffect(()=>{n()},[N,r]),c.useEffect(()=>{t.teamId?h(t.teamId):O([])},[t.teamId]);const n=async()=>{try{const a=[];N&&a.push(fetch(`/api/teams/${N}`).then(o=>o.ok?o.json():null)),r&&a.push(fetch(`/api/teams/${r}`).then(o=>o.ok?o.json():null));const y=(await Promise.all(a)).filter(o=>o!==null);if(A(y),y.length>0){const o=N||r||y[0].id;v(_=>({..._,teamId:o}))}}catch(a){console.error("Failed to fetch match teams:",a)}},h=async a=>{try{const i=await fetch(`/api/players?teamId=${a}`);if(i.ok){const y=await i.json();O(y)}}catch(i){console.error("Failed to fetch players:",i)}},p=a=>!["TIMEOUT"].includes(a),k=a=>["TWO_POINT_MADE","THREE_POINT_MADE"].includes(a),P=async a=>{a.preventDefault(),g(""),d(!0);try{const i=await fetch(`/api/matches/${j}/events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,minute:parseInt(t.minute),playerId:t.playerId||void 0,assistPlayerId:t.assistPlayerId||void 0})});if(!i.ok){const y=await i.json();throw new Error(y.error||"Failed to add event")}T(),v({eventType:"TWO_POINT_MADE",minute:"",teamId:t.teamId,playerId:"",assistPlayerId:"",description:""})}catch(i){g(i.message||"Failed to add event")}finally{d(!1)}},B=[{value:"TWO_POINT_MADE",label:"2-Point Made"},{value:"TWO_POINT_MISSED",label:"2-Point Missed"},{value:"THREE_POINT_MADE",label:"3-Point Made"},{value:"THREE_POINT_MISSED",label:"3-Point Missed"},{value:"FREE_THROW_MADE",label:"Free Throw Made"},{value:"FREE_THROW_MISSED",label:"Free Throw Missed"},{value:"ASSIST",label:"Assist"},{value:"REBOUND_OFFENSIVE",label:"Offensive Rebound"},{value:"REBOUND_DEFENSIVE",label:"Defensive Rebound"},{value:"STEAL",label:"Steal"},{value:"BLOCK",label:"Block"},{value:"TURNOVER",label:"Turnover"},{value:"FOUL_PERSONAL",label:"Personal Foul"},{value:"FOUL_TECHNICAL",label:"Technical Foul"},{value:"FOUL_FLAGRANT",label:"Flagrant Foul"},{value:"SUBSTITUTION_IN",label:"Substitution In"},{value:"SUBSTITUTION_OUT",label:"Substitution Out"},{value:"TIMEOUT",label:"Timeout"},{value:"INJURY",label:"Injury"},{value:"OTHER",label:"Other"}];return e.jsx(ee,{open:b,onOpenChange:a=>{a||M()},children:e.jsxs(se,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Add Match Event"}),e.jsx(re,{children:"Record an event that occurred during this match (goal, card, substitution, etc.)."})]}),u&&e.jsxs(G,{variant:"destructive",children:[S.AlertCircle?e.jsx(S.AlertCircle,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),e.jsx($,{children:u})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"modal-eventType",children:["Event Type ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(R,{value:t.eventType,onValueChange:a=>v(i=>({...i,eventType:a,assistPlayerId:""})),required:!0,children:[e.jsx(D,{id:"modal-eventType",children:e.jsx(C,{})}),e.jsx(L,{children:B.map(a=>e.jsx(f,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"modal-minute",children:[S.Clock?e.jsx(S.Clock,{className:"inline h-4 w-4 mr-2"}):null,"Minute ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(F,{id:"modal-minute",type:"number",value:t.minute,onChange:a=>v(i=>({...i,minute:a.target.value})),required:!0,min:"0",max:"120",placeholder:"23"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"modal-teamId",children:["Team ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(R,{value:t.teamId,onValueChange:a=>{v(i=>({...i,teamId:a,playerId:"",assistPlayerId:""}))},required:!0,children:[e.jsx(D,{id:"modal-teamId",children:e.jsx(C,{placeholder:"Select a team"})}),e.jsx(L,{children:U.map(a=>e.jsx(f,{value:a.id,children:a.name},a.id))})]})]}),p(t.eventType)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"modal-playerId",children:"Player"}),e.jsxs(R,{value:t.playerId,onValueChange:a=>v(i=>({...i,playerId:a})),disabled:!t.teamId,children:[e.jsx(D,{id:"modal-playerId",children:e.jsx(C,{placeholder:"Select a player"})}),e.jsx(L,{children:E.map(a=>e.jsxs(f,{value:a.id,children:[a.firstName," ",a.lastName]},a.id))})]})]})]}),k(t.eventType)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"modal-assistPlayerId",children:"Assist Player"}),e.jsxs(R,{value:t.assistPlayerId||"__none",onValueChange:a=>v(i=>({...i,assistPlayerId:a==="__none"?"":a})),disabled:!t.teamId,children:[e.jsx(D,{id:"modal-assistPlayerId",children:e.jsx(C,{placeholder:"No assist"})}),e.jsxs(L,{children:[e.jsx(f,{value:"__none",children:"No assist"}),E.map(a=>e.jsxs(f,{value:a.id,children:[a.firstName," ",a.lastName]},a.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"modal-description",children:"Description"}),e.jsx(ne,{id:"modal-description",rows:2,value:t.description,onChange:a=>v(i=>({...i,description:a.target.value})),placeholder:"Additional details about the event..."})]}),e.jsxs(le,{children:[e.jsx(w,{type:"button",variant:"outline",onClick:M,disabled:I,children:"Cancel"}),e.jsx(w,{type:"submit",disabled:I,children:I?e.jsxs(e.Fragment,{children:[S.Loader2?e.jsx(S.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Adding..."]}):"Add Event"})]})]})]})})}function ye({matchId:j,team1Id:N,team2Id:r,existingMatchPlayers:b=[],isOpen:M,onClose:T,onSuccess:U}){const[A,E]=c.useState([]),[O,I]=c.useState([]),[d,u]=c.useState(!1),[g,t]=c.useState(""),[v,S]=c.useState(!1),[l,n]=c.useState({playerId:"",teamId:"",started:!1,position:"",jerseyNumber:"",minutesPlayed:""}),[h,p]=c.useState({});c.useEffect(()=>{J(()=>import("./lucide-react.elpkBkAp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])).then(a=>{p({AlertCircle:a.AlertCircle,Loader2:a.Loader2,Plus:a.Plus})})},[]),c.useEffect(()=>{k()},[N,r]),c.useEffect(()=>{l.teamId?P(l.teamId):E([])},[l.teamId,b]);const k=async()=>{try{const a=[];N&&a.push(fetch(`/api/teams/${N}`).then(o=>o.ok?o.json():null)),r&&a.push(fetch(`/api/teams/${r}`).then(o=>o.ok?o.json():null));const y=(await Promise.all(a)).filter(o=>o!==null);if(I(y),y.length>0){const o=N||r||y[0].id;n(_=>({..._,teamId:o}))}}catch(a){console.error("Failed to fetch match teams:",a)}},P=async a=>{try{const i=await fetch(`/api/players?teamId=${a}`);if(i.ok){const y=await i.json(),o=new Set(b.map(H=>H.playerId||H.player?.id).filter(H=>!!H)),_=y.filter(H=>!o.has(H.id));E(_)}}catch(i){console.error("Failed to fetch players:",i)}},B=async a=>{a.preventDefault(),t(""),u(!0);try{const i=await fetch(`/api/matches/${j}/players`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...l,jerseyNumber:l.jerseyNumber?parseInt(l.jerseyNumber):void 0,minutesPlayed:l.minutesPlayed?parseInt(l.minutesPlayed):void 0})});if(!i.ok){const y=await i.json();throw new Error(y.error||"Failed to add player")}U()}catch(i){t(i.message||"Failed to add player")}finally{u(!1)}};return e.jsxs(ee,{open:M,onOpenChange:a=>{a||T()},children:[e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Add Player to Match"}),e.jsx(re,{children:"Select a team and player to add to this match."})]}),g&&e.jsxs(G,{variant:"destructive",children:[h.AlertCircle?e.jsx(h.AlertCircle,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),e.jsx($,{children:g})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"modal-teamId",children:["Team ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(R,{value:l.teamId,onValueChange:a=>{n(i=>({...i,teamId:a,playerId:""}))},required:!0,children:[e.jsx(D,{id:"modal-teamId",children:e.jsx(C,{placeholder:"Select a team"})}),e.jsx(L,{children:O.map(a=>e.jsx(f,{value:a.id,children:a.name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{htmlFor:"modal-playerId",children:["Player ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:()=>S(!0),disabled:!l.teamId,children:[h.Plus?e.jsx(h.Plus,{className:"mr-2 h-4 w-4"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Add New Player"]})]}),e.jsxs(R,{value:l.playerId,onValueChange:a=>n(i=>({...i,playerId:a})),required:!0,disabled:!l.teamId,children:[e.jsx(D,{id:"modal-playerId",children:e.jsx(C,{placeholder:"Select a player"})}),e.jsx(L,{children:A.map(a=>e.jsxs(f,{value:a.id,children:[a.firstName," ",a.lastName,a.jerseyNumber?` (#${a.jerseyNumber})`:""]},a.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"modal-position",children:"Position"}),e.jsxs(R,{value:l.position||void 0,onValueChange:a=>n(i=>({...i,position:a})),children:[e.jsx(D,{id:"modal-position",children:e.jsx(C,{placeholder:"Select position (optional)"})}),e.jsxs(L,{children:[e.jsx(f,{value:"PG",children:"Point Guard (PG)"}),e.jsx(f,{value:"SG",children:"Shooting Guard (SG)"}),e.jsx(f,{value:"SF",children:"Small Forward (SF)"}),e.jsx(f,{value:"PF",children:"Power Forward (PF)"}),e.jsx(f,{value:"C",children:"Center (C)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"modal-jerseyNumber",children:"Jersey #"}),e.jsx(F,{id:"modal-jerseyNumber",type:"number",value:l.jerseyNumber,onChange:a=>n(i=>({...i,jerseyNumber:a.target.value})),min:"0",max:"99"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"modal-minutesPlayed",children:"Minutes"}),e.jsx(F,{id:"modal-minutesPlayed",type:"number",value:l.minutesPlayed,onChange:a=>n(i=>({...i,minutesPlayed:a.target.value})),min:"0",max:"120"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{id:"modal-started",checked:l.started,onCheckedChange:a=>n(i=>({...i,started:a===!0}))}),e.jsx(x,{htmlFor:"modal-started",className:"cursor-pointer",children:"Started"})]}),e.jsxs(le,{children:[e.jsx(w,{type:"button",variant:"outline",onClick:T,disabled:d,children:"Cancel"}),e.jsx(w,{type:"submit",disabled:d,children:d?e.jsxs(e.Fragment,{children:[h.Loader2?e.jsx(h.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Adding..."]}):"Add Player"})]})]})]}),e.jsx(Ne,{team1Id:N,team2Id:r,isOpen:v,onClose:()=>S(!1),onSuccess:async a=>{S(!1),l.teamId&&(await P(l.teamId),n(i=>({...i,playerId:a.id})))}})]})}function Ke({matchId:j,initialMatch:N}){const[r,b]=c.useState(N?{...N,matchPlayers:[],events:[]}:null),[M,T]=c.useState(!N),[U,A]=c.useState(!1),[E,O]=c.useState(""),[I,d]=c.useState(!1),[u,g]=c.useState(!1),[t,v]=c.useState({});c.useEffect(()=>{J(()=>import("./lucide-react.elpkBkAp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])).then(s=>{v({Calendar:s.Calendar,Clock:s.Clock,Trophy:s.Trophy,Users:s.Users,Activity:s.Activity,Goal:s.Goal,Card:s.Square,Edit:s.Edit,ArrowLeft:s.ArrowLeft,Plus:s.Plus,AlertCircle:s.AlertCircle,Loader2:s.Loader2,Shirt:s.Shirt})})},[]),c.useEffect(()=>{j?S():(O("Match ID is required"),T(!1))},[j]);const S=async()=>{if(!j){O("Match ID is required"),T(!1);return}try{T(!0),O("");const s=await fetch(`/api/matches/${j}`);if(!s.ok){const z=await s.json().catch(()=>({error:"Failed to fetch match"}));throw new Error(z.error||`Server returned ${s.status}`)}const m=await s.json();if(!m||!m.id)throw new Error("Invalid match data received");const V={...m,matchPlayers:m.matchPlayers||[],events:m.events||[]};b(V),T(!1),A(!0),n().finally(()=>A(!1))}catch(s){O(s.message||"Failed to load match"),T(!1)}},l=async()=>{try{const s=await fetch(`/api/matches/${j}/players`);if(s.ok){const m=await s.json();b(V=>V&&{...V,matchPlayers:m||[]})}}catch(s){console.error("Failed to refresh match players:",s)}},n=async()=>{try{const[s,m]=await Promise.all([fetch(`/api/matches/${j}/players`).catch(()=>({ok:!1})),fetch(`/api/matches/${j}/events`).catch(()=>({ok:!1}))]),V=s.ok&&s instanceof Response?await s.json():[],z=m.ok&&m instanceof Response?await m.json():[];b(Y=>Y&&{...Y,matchPlayers:V||[],events:z||[]})}catch(s){console.warn("Failed to fetch match details:",s)}},h=s=>r?.matchPlayers?r.matchPlayers.filter(m=>m.teamId===s):[],p=s=>r?.events?r.events.filter(m=>m.teamId===s):[],k=s=>s==="LIVE"?"destructive":s==="COMPLETED"?"default":"secondary";if(M||!r&&!E)return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ie,{className:"h-12 w-full"}),e.jsx(ie,{className:"h-64 w-full"})]});if(E||!r)return e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs(G,{variant:"destructive",children:[t.AlertCircle?e.jsx(t.AlertCircle,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),e.jsx($,{children:E||"Match not found"})]})});const P=de(r),B=oe(r),a=me(r),i=he(r),y=je(r),o=xe(r),_=ue(r);return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 pb-6 border-b",children:[e.jsxs("div",{children:[e.jsx(w,{variant:"ghost",size:"sm",asChild:!0,className:"mb-2",children:e.jsxs("a",{href:"/admin/matches","data-astro-prefetch":!0,children:[t.ArrowLeft?e.jsx(t.ArrowLeft,{className:"mr-2 h-4 w-4"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Back to Matches"]})}),e.jsx("h1",{className:"text-3xl font-heading font-semibold text-foreground",children:"Match Details"})]}),r&&e.jsx(w,{asChild:!0,children:e.jsxs("a",{href:`/admin/matches/${j}`,"data-astro-prefetch":!0,children:[t.Edit?e.jsx(t.Edit,{className:"mr-2 h-4 w-4"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Edit Match"]})})]}),E&&e.jsxs(G,{variant:"destructive",children:[t.AlertCircle?e.jsx(t.AlertCircle,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),e.jsx($,{children:E})]}),U&&e.jsxs(G,{children:[t.Loader2?e.jsx(t.Loader2,{className:"h-4 w-4 animate-spin"}):e.jsx("span",{className:"h-4 w-4"}),e.jsx($,{children:"Loading players and events..."})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx(q,{children:e.jsx(K,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex-1 text-center",children:[B&&e.jsx("img",{src:B,alt:P,className:"w-24 h-24 mx-auto mb-4 object-contain"}),e.jsx("h2",{className:"text-2xl font-heading font-semibold mb-2",children:P}),r.team1Score!==null&&r.team1Score!==void 0&&e.jsx("div",{className:"text-5xl font-bold",children:r.team1Score})]}),e.jsxs("div",{className:"flex-shrink-0 text-center min-w-[200px]",children:[e.jsx(W,{variant:k(r.status),className:"mb-4",children:r.status}),r.date&&e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.Calendar?e.jsx(t.Calendar,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),new Date(r.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.Clock?e.jsx(t.Clock,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),new Date(r.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),y&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.Trophy?e.jsx(t.Trophy,{className:"h-4 w-4"}):e.jsx("span",{className:"h-4 w-4"}),y]}),r.season&&e.jsxs("div",{className:"text-xs opacity-85",children:["Season: ",r.season.name]})]})]}),e.jsxs("div",{className:"flex-1 text-center",children:[i&&e.jsx("img",{src:i,alt:a,className:"w-24 h-24 mx-auto mb-4 object-contain"}),e.jsx("h2",{className:"text-2xl font-heading font-semibold mb-2",children:a}),r.team2Score!==null&&r.team2Score!==void 0&&e.jsx("div",{className:"text-5xl font-bold",children:r.team2Score})]})]})})}),e.jsxs(q,{children:[e.jsx(Q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(X,{className:"flex items-center gap-2",children:[t.Users?e.jsx(t.Users,{className:"h-6 w-6"}):e.jsx("span",{className:"h-6 w-6"}),"Match Players",r.matchPlayers&&r.matchPlayers.length>0&&e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",r.matchPlayers.length,")"]})]}),e.jsxs(w,{size:"sm",variant:"outline",onClick:()=>d(!0),children:[t.Plus?e.jsx(t.Plus,{className:"mr-2 h-4 w-4"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Add Player"]})]})}),e.jsx(K,{children:r.matchPlayers&&r.matchPlayers.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b",children:P}),e.jsx("div",{className:"space-y-2",children:h(o).map(s=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("strong",{children:[s.player.firstName," ",s.player.lastName]}),s.jerseyNumber&&e.jsxs(W,{variant:"secondary",className:"gap-1",children:[t.Shirt?e.jsx(t.Shirt,{className:"h-3 w-3"}):e.jsx("span",{className:"h-3 w-3"}),s.jerseyNumber]}),s.started&&e.jsx(W,{variant:"default",children:"Started"}),s.position&&e.jsx("span",{className:"text-sm text-muted-foreground",children:s.position}),s.minutesPlayed!==null&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.minutesPlayed,"'"]})]})},s.id))})]}),_&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b",children:a}),e.jsx("div",{className:"space-y-2",children:h(_).map(s=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("strong",{children:[s.player.firstName," ",s.player.lastName]}),s.jerseyNumber&&e.jsxs(W,{variant:"secondary",className:"gap-1",children:[t.Shirt?e.jsx(t.Shirt,{className:"h-3 w-3"}):e.jsx("span",{className:"h-3 w-3"}),s.jerseyNumber]}),s.started&&e.jsx(W,{variant:"default",children:"Started"}),s.position&&e.jsx("span",{className:"text-sm text-muted-foreground",children:s.position}),s.minutesPlayed!==null&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.minutesPlayed,"'"]})]})},s.id))})]})]}):e.jsxs("div",{className:"text-center py-12",children:[t.Users?e.jsx(t.Users,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}):e.jsx("span",{className:"h-12 w-12 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No players added to this match yet"})]})})]}),e.jsxs(q,{children:[e.jsx(Q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(X,{className:"flex items-center gap-2",children:[t.Activity?e.jsx(t.Activity,{className:"h-6 w-6"}):e.jsx("span",{className:"h-6 w-6"}),"Match Events",r.events&&r.events.length>0&&e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",r.events.length,")"]})]}),e.jsxs(w,{size:"sm",variant:"outline",onClick:()=>g(!0),children:[t.Plus?e.jsx(t.Plus,{className:"mr-2 h-4 w-4"}):e.jsx("span",{className:"mr-2 h-4 w-4"}),"Add Event"]})]})}),e.jsx(K,{children:r.events&&r.events.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b",children:P}),e.jsx("div",{className:"space-y-3",children:p(o).map(s=>{const m=()=>["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE"].includes(s.eventType)?"border-green-500 bg-green-50":["TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED"].includes(s.eventType)?"border-orange-500 bg-orange-50":s.eventType==="FOUL_PERSONAL"?"border-yellow-500 bg-yellow-50":s.eventType==="FOUL_TECHNICAL"?"border-orange-500 bg-orange-50":s.eventType==="FOUL_FLAGRANT"||s.eventType==="TURNOVER"?"border-red-500 bg-red-50":["ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE"].includes(s.eventType)?"border-blue-500 bg-blue-50":"border-gray-500 bg-gray-50";return e.jsx("div",{className:`p-4 border-l-4 rounded-r-lg ${m()}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE","TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED"].includes(s.eventType)&&(t.Goal?e.jsx(t.Goal,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),["FOUL_PERSONAL","FOUL_TECHNICAL","FOUL_FLAGRANT"].includes(s.eventType)&&(t.Card?e.jsx(t.Card,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),["ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE","TURNOVER"].includes(s.eventType)&&(t.Activity?e.jsx(t.Activity,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),!["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE","TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED","FOUL_PERSONAL","FOUL_TECHNICAL","FOUL_FLAGRANT","ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE","TURNOVER"].includes(s.eventType)&&(t.Activity?e.jsx(t.Activity,{className:"h-5 w-5 text-gray-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold mb-1",children:[Z[s.eventType]||s.eventType," - ",s.minute,"'"]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.player&&e.jsx("div",{children:e.jsxs("strong",{children:[s.player.firstName," ",s.player.lastName]})}),s.assistPlayer&&e.jsxs("div",{children:["Assist: ",s.assistPlayer.firstName," ",s.assistPlayer.lastName]}),s.description&&e.jsx("div",{className:"italic",children:s.description})]})]})]})},s.id)})})]}),_&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b",children:a}),e.jsx("div",{className:"space-y-3",children:p(_).map(s=>{const m=()=>["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE"].includes(s.eventType)?"border-green-500 bg-green-50":["TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED"].includes(s.eventType)?"border-orange-500 bg-orange-50":s.eventType==="FOUL_PERSONAL"?"border-yellow-500 bg-yellow-50":s.eventType==="FOUL_TECHNICAL"?"border-orange-500 bg-orange-50":s.eventType==="FOUL_FLAGRANT"||s.eventType==="TURNOVER"?"border-red-500 bg-red-50":["ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE"].includes(s.eventType)?"border-blue-500 bg-blue-50":"border-gray-500 bg-gray-50";return e.jsx("div",{className:`p-4 border-l-4 rounded-r-lg ${m()}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE","TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED"].includes(s.eventType)&&(t.Goal?e.jsx(t.Goal,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),["FOUL_PERSONAL","FOUL_TECHNICAL","FOUL_FLAGRANT"].includes(s.eventType)&&(t.Card?e.jsx(t.Card,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),["ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE","TURNOVER"].includes(s.eventType)&&(t.Activity?e.jsx(t.Activity,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),!["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE","TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED","FOUL_PERSONAL","FOUL_TECHNICAL","FOUL_FLAGRANT","ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE","TURNOVER"].includes(s.eventType)&&(t.Activity?e.jsx(t.Activity,{className:"h-5 w-5 text-gray-600 flex-shrink-0 mt-0.5"}):e.jsx("span",{className:"h-5 w-5 flex-shrink-0 mt-0.5"})),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold mb-1",children:[Z[s.eventType]||s.eventType," - ",s.minute,"'"]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.player&&e.jsx("div",{children:e.jsxs("strong",{children:[s.player.firstName," ",s.player.lastName]})}),s.assistPlayer&&e.jsxs("div",{children:["Assist: ",s.assistPlayer.firstName," ",s.assistPlayer.lastName]}),s.description&&e.jsx("div",{className:"italic",children:s.description})]})]})]})},s.id)})})]})]}):e.jsxs("div",{className:"text-center py-12",children:[t.Activity?e.jsx(t.Activity,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}):e.jsx("span",{className:"h-12 w-12 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No events recorded for this match yet"})]})})]}),r.events&&r.events.length>0&&e.jsxs(q,{children:[e.jsx(Q,{children:e.jsxs(X,{className:"flex items-center gap-2",children:[t.Clock?e.jsx(t.Clock,{className:"h-6 w-6"}):e.jsx("span",{className:"h-6 w-6"}),"Match Timeline"]})}),e.jsx(K,{children:e.jsx("div",{className:"space-y-4",children:r.events.sort((s,m)=>s.minute-m.minute).map((s,m)=>e.jsxs("div",{className:"relative pl-12 pb-6",children:[m<r.events.length-1&&e.jsx("div",{className:"absolute left-6 top-8 bottom-0 w-0.5 bg-border"}),e.jsxs("div",{className:"absolute left-0 top-0 w-12 h-12 rounded-full bg-background border-2 border-border flex items-center justify-center font-bold text-sm z-10",children:[s.minute,"'"]}),e.jsx(q,{className:"ml-4",children:e.jsxs(K,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE","TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED"].includes(s.eventType)&&(t.Goal?e.jsx(t.Goal,{className:"h-5 w-5 text-green-600"}):e.jsx("span",{className:"h-5 w-5"})),["FOUL_PERSONAL","FOUL_TECHNICAL","FOUL_FLAGRANT"].includes(s.eventType)&&(t.Card?e.jsx(t.Card,{className:"h-5 w-5 text-yellow-600"}):e.jsx("span",{className:"h-5 w-5"})),["ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE","TURNOVER"].includes(s.eventType)&&(t.Activity?e.jsx(t.Activity,{className:"h-5 w-5 text-blue-600"}):e.jsx("span",{className:"h-5 w-5"})),!["TWO_POINT_MADE","THREE_POINT_MADE","FREE_THROW_MADE","TWO_POINT_MISSED","THREE_POINT_MISSED","FREE_THROW_MISSED","FOUL_PERSONAL","FOUL_TECHNICAL","FOUL_FLAGRANT","ASSIST","STEAL","BLOCK","REBOUND_OFFENSIVE","REBOUND_DEFENSIVE","TURNOVER"].includes(s.eventType)&&(t.Activity?e.jsx(t.Activity,{className:"h-5 w-5 text-gray-600"}):e.jsx("span",{className:"h-5 w-5"})),e.jsx("div",{className:"font-semibold",children:Z[s.eventType]||s.eventType}),e.jsx(W,{variant:"outline",children:H(s.teamId)})]}),s.player&&e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs("strong",{children:[s.player.firstName," ",s.player.lastName]})}),s.assistPlayer&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Assist: ",s.assistPlayer.firstName," ",s.assistPlayer.lastName]}),s.description&&e.jsx("div",{className:"text-sm text-muted-foreground italic mt-2",children:s.description})]})})]},s.id))})})]})]}),r&&e.jsx(ye,{matchId:j,team1Id:o,team2Id:_,existingMatchPlayers:r.matchPlayers||[],isOpen:I,onClose:()=>d(!1),onSuccess:()=>{d(!1),l(),n()}}),r&&e.jsx(pe,{matchId:j,team1Id:o,team2Id:_,isOpen:u,onClose:()=>g(!1),onSuccess:()=>{g(!1),n()}})]});function H(s){return o===s?P:_===s?a:"Unknown Team"}}export{Ke as default};

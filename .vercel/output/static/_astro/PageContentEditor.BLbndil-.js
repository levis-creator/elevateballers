import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.Z6aMusZW.js";import{B as m}from"./button.BWaXVklz.js";import{I as h}from"./input.DYfGnR1o.js";import{L as o}from"./label.ByuxEscq.js";import{T as y}from"./textarea.ntLCWltE.js";import{C as M}from"./checkbox.qiCfuuF1.js";import{C as p,a as x,b as u,c as f,d as g}from"./card.YuvTJRVG.js";import{A as S,a as T}from"./alert.BWe5-cIC.js";import{S as j}from"./skeleton.B3vSOSjr.js";import"./separator.BcNt21XF.js";import{A as U}from"./arrow-left.DTOvvTq7.js";import{C as O}from"./circle-alert.DSB0BqUH.js";import{C as R}from"./circle-check-big.C0mK4qk5.js";import{L as $}from"./loader-circle.DAcaG-Yh.js";import{S as q}from"./save.BcFhAao1.js";import{X as z}from"./x.B_0Xwiyu.js";import"./utils.CDN07tui.js";import"./index.CO5Cc353.js";import"./index.EfZGvMir.js";import"./index.CTkzGMNT.js";import"./index.D9ngwW3m.js";import"./index.B8x0sxYY.js";import"./check.BilKxX2O.js";import"./createLucideIcon.DXTouTbc.js";function pe({pageId:a}){const[D,v]=n.useState(!!a),[i,b]=n.useState(!1),[N,d]=n.useState(""),[F,C]=n.useState(!1),[r,l]=n.useState({slug:"",title:"",content:"",metaTitle:"",metaDescription:"",published:!0});n.useEffect(()=>{a&&P()},[a]);const P=async()=>{try{v(!0);const t=await fetch(`/api/pages/${a}`);if(!t.ok)throw new Error("Failed to fetch page");const s=await t.json();l({slug:s.slug,title:s.title,content:s.content,metaTitle:s.metaTitle||"",metaDescription:s.metaDescription||"",published:s.published})}catch(t){d(t.message||"Failed to load page")}finally{v(!1)}},L=t=>{const s=t||r.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");l(c=>({...c,slug:s}))},E=t=>{if(l(s=>({...s,title:t})),!prev.slug){const s=t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");l(c=>({...c,slug:s}))}},k=async t=>{t.preventDefault(),b(!0),d(""),C(!1);try{const s=a?`/api/pages/${a}`:"/api/pages",c=a?"PUT":"POST",A={...r,metaTitle:r.metaTitle||void 0,metaDescription:r.metaDescription||void 0},w=await fetch(s,{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!w.ok){const B=await w.json();throw new Error(B.error||"Failed to save page")}C(!0),setTimeout(()=>{window.location.href="/admin/pages"},1500)}catch(s){d(s.message||"Failed to save page")}finally{b(!1)}};return D?e.jsxs("div",{className:"space-y-4",children:[e.jsx(j,{className:"h-12 w-full"}),e.jsx(j,{className:"h-64 w-full"}),e.jsx(j,{className:"h-12 w-full"})]}):e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 pb-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-heading font-semibold mb-2 text-foreground",children:a?"Edit Page":"Create New Page"}),e.jsx("p",{className:"text-muted-foreground",children:a?"Update page content and settings":"Create a new static page"})]}),e.jsx(m,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/admin/pages","data-astro-prefetch":!0,children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Back to List"]})})]}),N&&e.jsxs(S,{variant:"destructive",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx(T,{children:N})]}),F&&e.jsxs(S,{className:"border-green-500 bg-green-50 text-green-900",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx(T,{children:"Page saved successfully! Redirecting..."})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(u,{children:"Basic Information"}),e.jsx(f,{children:"Page title, slug, and content"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"title",children:["Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"title",type:"text",value:r.title,onChange:t=>E(t.target.value),required:!0,disabled:i,placeholder:"Page Title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"slug",children:["Slug (URL) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"slug",type:"text",value:r.slug,onChange:t=>L(t.target.value),required:!0,disabled:i||!!a,placeholder:"page-url-slug"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"URL-friendly identifier. Auto-generated from title if left empty. Cannot be changed after creation."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"content",children:["Content ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(y,{id:"content",rows:15,value:r.content,onChange:t=>l(s=>({...s,content:t.target.value})),required:!0,disabled:i,placeholder:"Page content (HTML supported)",className:"font-mono text-sm"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Full page content. HTML is supported."})]})]})]}),e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(u,{children:"SEO & Metadata"}),e.jsx(f,{children:"Search engine optimization settings"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"metaTitle",children:"Meta Title"}),e.jsx(h,{id:"metaTitle",type:"text",value:r.metaTitle,onChange:t=>l(s=>({...s,metaTitle:t.target.value})),disabled:i,placeholder:"SEO title (optional)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Used for search engines. If empty, page title will be used."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"metaDescription",children:"Meta Description"}),e.jsx(y,{id:"metaDescription",rows:3,value:r.metaDescription,onChange:t=>l(s=>({...s,metaDescription:t.target.value})),disabled:i,placeholder:"SEO description (optional)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Brief description for search engines (150-160 characters recommended)."})]})]})]}),e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(u,{children:"Publishing"}),e.jsx(f,{children:"Control page visibility"})]}),e.jsx(g,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"published",checked:r.published,onCheckedChange:t=>l(s=>({...s,published:t})),disabled:i}),e.jsx(o,{htmlFor:"published",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold",children:"Publish this page"}),e.jsx("span",{className:"text-xs text-muted-foreground font-normal",children:"Make it visible on the website"})]})})]})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(m,{type:"submit",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),a?"Update Page":"Create Page"]})}),e.jsx(m,{type:"button",variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/admin/pages","data-astro-prefetch":!0,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Cancel"]})})]})]})]})}export{pe as default};
